<button class="work-effort-report w-100 d-flex align-items-stretch text-left position-relative p-0 row no-gutters"
        (click)="expanded = !expanded"
        [ngClass]="expanded ? 'expanded' : 'collapsed'">
  <span class="col-12 col-lg-3 name-cell">
    <small class="d-block text-truncate">
      {{'portal.work-efforts.work-effort-report.name-cell.title' | translate}}
    </small>
    <h3 class="period-title mb-0 mt-1 my-lg-1">
      <fa-icon [icon]="['fas', expanded ? 'caret-up' : 'caret-down']"
               class="mr-1"></fa-icon>
      <small *ngIf="isBeforeEmployment(workEffortsReport); else date">
        {{'portal.work-efforts.work-effort-report.name-cell.before-unemployment.label' | translate}}
      </small>
      <ng-template #date>{{'portal.work-efforts.month.' + getMonthValue(workEffortsReport.controlPeriod?.value) | translate}}
        {{workEffortsReport.controlPeriod?.value | date:'yyyy'}}</ng-template>
    </h3>
  </span>
  <span class="col-12 col-lg-3 pdf-cell">
    <button *ngIf="workEffortsReport.documentId"
            class="pdf-link p-0"
       (click)="$event.stopPropagation();downloadPdf(workEffortsReport)">
    <fa-icon [icon]="['far', 'file-pdf']"
             class="text-primary mr-1"></fa-icon>
      {{'portal.work-efforts.work-effort-report.pdf-file.name' | translate}}{{getDateStringFromControlPeriod(workEffortsReport)}}.pdf</button>
  </span>
  <span class="col-12 col-lg-3 status-cell d-flex flex-column">
    <small class="status-label">
      {{'portal.work-efforts.edit-status.label' | translate}}
    </small>
    <div class="flex-grow-1">
      {{'portal.work-efforts.work-effort-report.edit-status.text' | translate}}:
      {{workEffortsReport.workEfforts.length}}
    </div>
  </span>
  <span class="col-12 col-lg-3 status-cell d-flex flex-column"
        [class.success]="isSentSuccessfully(workEffortsReport)">
    <small class="status-label">
      {{'portal.work-efforts.submit-status.label' | translate}}
    </small>
    <div class="flex-grow-1">
          {{'portal.work-efforts.submit-status.text.' + workEffortsReport.status
      | translate:{dateTime: getSubmissionDate(workEffortsReport) | date: 'dd.MM.yyyy HH:mm'} }}
    </div>
    <div class="success-icon-container text-center h-100 align-items-center">
      <fa-icon [icon]="['fas', 'check']"
               class="w-100"></fa-icon>
    </div>
  </span>
  <span class="expanded-indicator h-100">
  </span>
</button>

<!-- Collapse Panel -->
<ng-container *ngIf="expanded">
  <div class="arrow-container">
    <div class="arrow-down">
    </div>
  </div>

  <div class="collapse-panel">
    <a *ngIf="!isReportClosed(workEffortsReport)"
       [routerLink]="'/work-efforts/create'"
       class="btn btn-text add-work-effort-button w-100">
      <fa-icon [icon]="['fas', 'plus']"
               class="mr-1"></fa-icon>
      {{'portal.work-efforts.work-effort-report.add-work-effort.button.label' | translate}}
    </a>

    <ng-container *ngFor="let workEffort of workEffortsReport.workEfforts; let last = last">
      <div class="work-effort-divider"></div>

      <alv-work-effort (deleted)="removeWorkEffort($event)"
                       [nextSubmissionDate]="workEffortsReport.nextSubmissionDate"
                       [workEffortsReportId]="workEffortsReport.id"
                       [workEffort]="workEffort"></alv-work-effort>

      <div *ngIf="last"
           class="work-effort-divider"></div>
    </ng-container>

  </div>
</ng-container>

