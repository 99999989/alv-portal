os: linux
dist: trusty
group: stable
sudo: required
language: java
jdk: openjdk8
services:
- docker
env:
  global:
  - PROJECT_VERSION=0.0.1
  - NODE_VERSION=10.9.0
  # GIT_USER
  - secure: ZTaGCqbM4hReM1T2w9pURLYvOpNsTe/hiReJ86uZUqRkDzptEstFa/VSXpfBqInLvyuzS0UDEIbljBXdYLIyFFXwA6Zfa0kKmObCed8oDPPO09uO8rHqqvccdmMhKGf/UPO8yoHJViBZad00pOK6kQJHVcuav9Oenskkn4cE+eAg2D7FB12gRjShnI/NFf2t1lLwna2o2uhcSGrT4mOqm8U+ygjmjbmoXrc0fdl/3jh+0uV+G2PzLDO30B4AswVoCI0Wvg0/lALL/vQxggadTm4A61rUMvKVB3UmKrFVwp1Cza6B35+gSadYWOl+b/uC9qfmy8sG7CFxqYc/1jwGorZXGxGKC1Mh4OpZv6tbRokoQX4BZUU4XK687GsGZsDqGgM613r6i6K2NsXsKRpI3v6tuM+qeqiuh7tzYkxJgdPXZYlJ62kHdP+AqhNzFUusBWkhcUftvEb8sBMB1kCLLOhQV0NwQundDnaYGT8Tu13hgE+/cXvWbVqRfLPEUhY/xVMxjQF3PxXP9XG26j543aZEQy/udUTIeSkb8oHTI6RNBygCqgp+EU4xTJuWF678Yza139lcTs1luoxSZGqmmj7yiKEnzNerKVrraUkVZuQB0uWoUVx7lhAj6YHMHZcyOsxIFU2YYFwYazBytir5UZQFFONJyDc9hb9r7CY03WM=
  # GIT_PWD
  - secure: Dp92d/WvgpAuH1HuhfpxLyU9LBsfN5vLeRIazKdCNHUY4/uiScSlByzPB8Q81qgwwjCFIBcXF5H5o3BQ6zEafCpBoU6TCfX7zLPfT1ve7HD6iIFBLlwNWEEi1RDykH3Q3Fq3hXp1R3qaDwmkTSSHcxTAv5Faa9ITpviOkK6bErJEs0Y2wrOCj/TscjFbf/ayrigHAQ3JjEWBn4Wp3pHpC2axdWjYxWwf7OSHeXxcI+GZ1oNP+bCAgdB4+ufktkgMF2Vz9V2LIb/rmccXtgjRY6YFsZ0wXToX9yiW1DhTz3J1kHtboLk1RHDABJonOBVqmPalH/cUpOPEd3BUXxK2wcp78gRIEV70kdcwZ5BwukXw9sL19g1Vx1Qbwrwp7BzoJm6W4a9NR6x7rskdRuqu1BZQ50SByURcfWIY0zUBtvgfWdH9rrgVjMCkcaSgXHr9KClNWfEbLyAmRehcayZcZ+RURQfKNe9hvSeeP1UGoPp+IUcwG9oI1BZnrZJ3zxMCvg6VNxPno+Zk/aFUujv40Tx82v9PnfTl3EM8Oe3cIKxpmFTkHq73uockc1PQSeevUchfdO39mV9Hce5iIUz8VdmW8KaZpiRwnX8v4KYrlnJa8K+3UcgH4tPFj7aOSeX/hkCpbDORWJcUXC3kI9Zw9lPWO0PfA+axB6EeqXoBNys=
  # ARTIFACTORY_USERNAME
  - secure: g3IPTItQrRYG3ooBhQ5HFKNtntH2vnbtdm2kzepuZPN4l+Krqe5c1WEIo9V9je5qDVGcuu/Q3SuSgGMGVTNHVyD03AX4e0qVCHwU6nmlw5G7jn6IwuYGJnXh2866a43ZR98HGnhgVfcYa9nnU5MVfrqy7itrwnNMR3yRUy6NNOnX5tqC7NSyRRX/PAQtmd1BookLldfZCwQJGEC+pQflQzgnJake9c7+l6oEQlsJzBTufN/jvqyFfRP5zbIOrj8Rg17U41eYCK8NDhDg8+kXSy6KN4J3prmCQyTk3zI6fHUEoAOpwX+fVPyivd7WiTozNRQjiZ8L2PBb8NRLK8HQ48lBKMQgk5VJdJh5eOq2YO92pF7iAppUcXUE1BeYMUEyrwMuSnyLZPtbA77GXhLbVas9WBK7SJfEdRb7wpFhFIt81Yl3FVGG2AGnQ7r8QbH4dU6E9w0roS8jdW8S5ohGSSZTPDs8Zu5UvNtqqpsvADWsp7CxNqtcGR43hRg9krzXgqLtcQOlFgMBzZzvgI4u6Lq6ab2VbxyUELEPFBXnqWmqxCLwh7NNHqFg+hYH/nLF37Kf6QPvO81z91PjilcpT0l/if7VMj0CjTrXzCu7OrfpnnahN+CZBb1k5f4zzM5YfoH+19KvrQsUl11RViYz2xaTYEP9d5R11dEjPegisBk=
  # ARTIFACTORY_PASSWORD
  - secure: LKwUmz02BQuRcuvBkZ+uZ2lD/2z8j+/bKExpQoAIQKgJ4BS5ZR/ZylX68EUMmdTXCMFUj0OfDs/0hMAOhzGNlUlHm/NA2Fe0VHlTVbDyOvD1NPItY4ssuQuySQPx8VAGFlGazB8mnQGMa2aJc/qkN5oCo28Q8bDGmy3inwL4G2BZBSlyjx9mubVVd6shjyT84n67Fn1emAwt2OpzPzZZrlUOJwQuhZzor8WTViT1yp5nHCJIozbAQAw5tBqn4TzCKqoMnSqewammaIvXtXZv+XDVPaSFzTEYPld3ZNYHY4JMRc9qPV4PNae0KxBi7z4mH/a0n8IQg5TTN95zntksaDc/4/2zCzp/OTFcleKBzxOwiwKqJCgtw46Am4cA+HAC0XP+871s+x04IeE+qrDKgd2gfIuTuJERuASpEMN6EA3YoI/6qPhdv3kDDDJTtvkdc3cU1dQxkzoBtTHfTui4CbQFr3P+RC4T+tvwTUK/n7/SSRoNc9zVkBrsgxaoHykjxHly7hRQgXFmXceFApP29MMX5PXoUe1mjzs6VACpuB4PRWYKKVtx0Jqg3R09pg5PYz29HUtnx0Dq4ZXzcPHHEUiXHtbTpR8LnqrmRVwK3EizTPHsCPOQEWj70qruWhNtLNKorHEWmfMCmNDfqkEsRLD0aOZPuWmQ/tqoKzGg0eQ=
before_cache:
- rm -rf $HOME/.m2/repository/ch/admin/seco/alv-portal-*
cache:
  directories:
  - "$HOME/.m2"
  - alv-portal-ui/node_modules
install:
- ".ci-travis/install-nodejs.sh ${NODE_VERSION}"
- ".ci-travis/install-chrome.sh"
script:
- export BRANCH_VERSION_SUFFIX=$([ "$TRAVIS_BRANCH" == "master" ] && echo "" || echo
  "-${TRAVIS_BRANCH//\//-}")
- export BUILD_VERSION=$PROJECT_VERSION-build-$TRAVIS_BUILD_NUMBER$BRANCH_VERSION_SUFFIX
- ".ci-travis/maven-set-version.sh ${BUILD_VERSION}"
deploy:
- provider: script
  skip_cleanup: true
  script: ".ci-travis/maven-package.sh"
  on:
    all_branches: true
    condition: "$TRAVIS_BRANCH != master"
- provider: script
  skip_cleanup: true
  script: ".ci-travis/maven-deploy.sh ${ARTIFACTORY_USERNAME} ${ARTIFACTORY_PASSWORD}
    && .ci-travis/push-version-bump.sh ${BUILD_VERSION} ${GIT_USER} ${GIT_PWD}"
  on:
    branch: master
- provider: script
  skip_cleanup: true
  script: ".ci-travis/maven-deploy.sh ${ARTIFACTORY_USERNAME} ${ARTIFACTORY_PASSWORD}
    && .ci-travis/push-version-bump.sh ${BUILD_VERSION} ${GIT_USER} ${GIT_PWD}"
  on:
    all_branches: true
    condition: "$TRAVIS_BRANCH =~ ^release.*$"
- provider: script
  skip_cleanup: true
  script: ".ci-travis/maven-e2e.sh"
  on:
    all_branches: true
    condition: "$TRAVIS_EVENT_TYPE == cron"
notifications:
  webhooks:
    on_success: change
    on_failure: always
    on_start: never
