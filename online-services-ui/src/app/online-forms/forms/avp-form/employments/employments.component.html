<div class="row m-4">
  <form [formGroup]="form"
        class="col-md-12"
        novalidate>
    <os-notification class="mb-4" type="error" [message]="'You have errors in your form'" [additionalText]="'Please check for invalid fields'"></os-notification>
    <os-panel [panelTitle]="'Did you work for one or more employers in March 2018?'">
      <os-radio-button [control]="form.get('worked')">
      </os-radio-button>
    </os-panel>
    <ng-container *ngIf="form.value.worked">
      <os-panel-group [showArrow]="true"
                      [colorizeArrow]="true"
                      formArrayName="employments"
                      *ngFor="let employment of employments.controls; let i=index">
        <ng-container class="content">
          <os-panel [panelTitle]="'Employer ' + (i + 1)">
            <div [formGroupName]="i">
              <os-input-field label="Employer Name"
                              [control]="employment.get('employer')">
              </os-input-field>
              <os-date-interval-input [form]="employment.get('period')">
              </os-date-interval-input>
              <os-address-input [form]="employment.get('address')"></os-address-input>
            </div>
          </os-panel>
          <os-panel [showArrow]="true"
                    [colorizeArrow]="true">
            <os-document-upload></os-document-upload>
          </os-panel>
        </ng-container>
        <ng-container class="actions">
          <button class="btn btn-secondary mr-1"
                  *ngIf="employments.controls.length > 1"
                  type="button"
                  (click)="removeEmployment(i)">Remove Employment
          </button>
          <button class="btn btn-primary"
                  type="button"
                  (click)="addEmployment()">Add Employment
          </button>
        </ng-container>
      </os-panel-group>
    </ng-container>

    <os-panel [showArrow]="true"
              [panelTitle]="'Have you been self-employed in March 2018?'">
      <os-radio-button [control]="form.get('selfEmployed')"></os-radio-button>
    </os-panel>

    <os-panel *ngIf="form.value.selfEmployed"
              [showArrow]="true"
              [colorizeArrow]="true"
              [panelTitle]="'Please attach scanned receipts and settlements.'"
              [panelSubtitle]="'Optional'"
              [helpEntries]="helpTextService.uploads">
      <os-files-upload></os-files-upload>
    </os-panel>

    <os-panel [showArrow]="true"
              [panelTitle]="'Did you participate in a labor market measure in March 2018?'">
      <os-radio-button [control]="form.get('labourMarketMeasures')">
      </os-radio-button>
    </os-panel>

    <div class="d-flex my-4 mx-1">
      <div class="flex-grow-1"></div>
      <button class="btn btn-link mr-1">Cancel
      </button>
      <button class="btn btn-secondary mr-1">Save
      </button>
      <button
          class="btn btn-primary">Submit
      </button>
    </div>

  </form>
  <!-- For debugging purposes -->
  <div class="col-md-4"
       *ngIf="false">
    <h4>form.value for monthly employments component</h4>
    <pre>
    {{form.value|json}}
  </pre>
    <h4>Validity</h4>
    <p>form.valid:</p>
    <pre>
    {{form.valid}}
  </pre>
  </div>

</div>

